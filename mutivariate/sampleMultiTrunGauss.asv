function samples = sampleMultiTrunGauss(mu, sigma2, num_samples)
% sample from a truncated normal distribution N(mu, sigma2, >thres)

% Check which samples to reject
x = x(:,sum(x < 0,1) == nnz(si));
[~,n_acc] = size(x);
samples = [];
T = max(100, num_samples*10);
while size(samples,2)<num_samples
    Z = mvnrnd(mu,invUs/2, n_mc)';
    samples = [samples, Z(Z>thres)];
end
if num_samples == 1
    samples = samples(1,1);
else
    samples = samples(1,1:num_samples);
end